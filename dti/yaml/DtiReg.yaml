##############################################################################
## This file is part of 'SLAC Firmware Standard Library'.
## It is subject to the license terms in the LICENSE.txt file found in the
## top-level directory of this distribution and at:
##    https://confluence.slac.stanford.edu/display/ppareg/LICENSE.html.
## No part of 'SLAC Firmware Standard Library', including this file,
## may be copied, modified, propagated, or distributed except according to
## the terms contained in the LICENSE.txt file.
##############################################################################
#schemaversion 3.0.0
#once DtiReg.yaml

DtiReg: &DtiReg
  class: MMIODev
  configPrio: 1
  description: Status of timing frame reception
  size: 0x10000
  metadata:
    numUsLinks: &numUsLinks 7
  children:
    #########################################################
    usLinkEnable:
      at:
        offset: 0x0000
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkEnable
      sizeBits: 1
      lsBit: 0
      mode: RW
      description: Enable link
    #########################################################
    usLinkTagEnable:
      at:
        offset: 0x0000
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkTagEnable
      sizeBits: 1
      lsBit: 1
      mode: RW
      description: Enable link event tag support
    #########################################################
    usLinkL1Enable:
      at:
        offset: 0x0000
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkL1Enable
      sizeBits: 1
      lsBit: 2
      mode: RW
      description: Enable L1 trigger support
    #########################################################
    usLinkHdrOnly:
      at:
        offset: 0x0000
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkHdrOnly
      sizeBits: 1
      lsBit: 3
      mode: RW
      description: Forward only event header
    #########################################################
    usLinkPartition:
      at:
        offset: 0x0000
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkPartition
      sizeBits: 4
      lsBit: 4
      mode: RW
      description: Upstream link partition
    #########################################################
    usLinkTrigDelay:
      at:
        offset: 0x0001
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkTrigDelay
      sizeBits: 8
      lsBit: 0
      mode: RW
      description: Timing frame trigger delay
    #########################################################
    usLinkFwdMask:
      at:
        offset: 0x0002
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkFwdMask
      sizeBits: 13
      lsBit: 0
      mode: RW
      description: Upstream link forwarding mask
    #########################################################
    usLinkFwdMode:
      at:
        offset: 0x0003
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkFwdMode
      sizeBits: 1
      lsBit: 7
      mode: RW
      description: Upstream link forwarding mode (RR, RR+full)
    #########################################################
    usLinkDataSource:
      at:
        offset: 0x0004
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkDataSource
      sizeBits: 32
      mode: RW
      description: Data source identifier
    #########################################################
    usLinkDataType:
      at:
        offset: 0x0008
        stride: 16
        nelms: *numUsLinks
      class: IntField
      name: usLinkDataType
      sizeBits: 32
      mode: RW
      description: Data type identifier
    #########################################################
    usLinkUp:
      at:
        offset: 0x0070
      class: IntField
      name: usLinkUp
      sizeBits: 7
      mode: RO
      description: Upstream link status
    #########################################################
    bpLinkUp:
      at:
        offset: 0x0071
      class: IntField
      name: bpLinkUp
      sizeBits: 1
      lsBit: 7
      mode: RO
      description: Backplane link status
    #########################################################
    dsLinkUp:
      at:
        offset: 0x0072
      class: IntField
      name: dsLinkUp
      sizeBits: 7
      mode: RO
      description: Downstream link status
    #########################################################
    usLinkIndex:
      at:
        offset: 0x0074
      class: IntField
      name: usLinkIndex
      sizeBits: 4
      mode: RW
      description: Upstream link index
    #########################################################
    dsLinkIndex:
      at:
        offset: 0x0076
      class: IntField
      name: dsLinkIndex
      sizeBits: 4
      mode: RW
      description: Downstream link index
    #########################################################
    countClear:
      at:
        offset: 0x0077
      class: IntField
      name: countClear
      sizeBits: 1
      lsBit: 6
      mode: RW
      description: Clear link counters
    #########################################################
    countUpdate:
      at:
        offset: 0x0077
      class: IntField
      name: countUpdate
      sizeBits: 1
      lsBit: 7
      mode: RW
      description: Update link counters
    #########################################################
    usRxErrs:
      at:
        offset: 0x0080
      class: IntField
      name: usRxErrs
      sizeBits: 24
      mode: RO
      description: Indexed upstream link - rx errors count
    #########################################################
    usRemLinkID:
      at:
        offset: 0x0083
      class: IntField
      name: usRemLinkID
      sizeBits: 8
      mode: RO
      description: Indexed upstream link - remote link ID
    #########################################################
    usRxFull:
      at:
        offset: 0x0084
      class: IntField
      name: usRxFull
      sizeBits: 32
      mode: RO
      description: Indexed upstream link - rx full count
    #########################################################
    usRxInh:
      at:
        offset: 0x0088
      class: IntField
      name: usRxInh
      sizeBits: 32
      mode: RO
      description: Indexed upstream link - rx events inhibited
    #########################################################
    usIbEvt:
      at:
        offset: 0x008C
      class: IntField
      name: usIbEvt
      sizeBits: 32
      mode: RO
      description: Indexed upstream link - rx events forwarded
    #########################################################
    dsRxErrs:
      at:
        offset: 0x0090
      class: IntField
      name: dsRxErrs
      sizeBits: 32
      mode: RO
      description: Indexed downstream link - rx errors count
    #########################################################
    dsRxFull:
      at:
        offset: 0x0094
      class: IntField
      name: dsRxFull
      sizeBits: 32
      mode: RO
      description: Indexed downstream link - rx full count
    #########################################################
    dsRemLinkID:
      at:
        offset: 0x0097
      class: IntField
      name: dsRemLinkID
      sizeBits: 8
      mode: RO
      description: Indexed downstream link - remote link ID
    #########################################################
    dsObSent:
      at:
        offset: 0x0098
      class: IntField
      name: dsObSent
      sizeBits: 48
      mode: RO
      description: Indexed downstream link - tx words count
    #########################################################
    usAppObReceived:
      at:
        offset: 0x00A0
      class: IntField
      name: usAppObReceived
      sizeBits: 32
      mode: RO
      description: Indexed upstream link - rx control words count
    #########################################################
    usAppObSent:
      at:
        offset: 0x00A8
      class: IntField
      name: usAppObSent
      sizeBits: 32
      mode: RO
      description: Indexed upstream link - tx control words count
    #########################################################
    qpllLock:
      at:
        offset: 0x00B0
      class: IntField
      name: qpllLock
      sizeBits: 2
      mode: RO
      description: Lock status of QPLLs
    #########################################################
    bpTxInterval:
      at:
        offset: 0x00B2
      class: IntField
      name: bpTxInterval
      sizeBits: 8
      mode: RW
      description: rxFull push interval - 125MHz ticks
    #########################################################
    monClkRate:
      at:
        offset: 0x00B4
        stride: 4
        nelms: 4
      class: IntField
      name: monClkRate
      sizeBits: 29
      lsBit: 0
      mode: RO
      description: Monitor clock rate
    #########################################################
    monClkSlow:
      at:
        offset: 0x00B7
        stride: 4
        nelms: 4
      class: IntField
      name: monClkSlow
      sizeBits: 1
      lsBit: 5
      mode: RO
      description: Monitor clock too slow
    #########################################################
    monClkFast:
      at:
        offset: 0x00B7
        stride: 4
        nelms: 4
      class: IntField
      name: monClkFast
      sizeBits: 1
      lsBit: 6
      mode: RO
      description: Monitor clock too fast
    #########################################################
    monClkLock:
      at:
        offset: 0x00B7
        stride: 4
        nelms: 4
      class: IntField
      name: monClkLock
      sizeBits: 1
      lsBit: 7
      mode: RO
      description: Monitor clock locked
    #########################################################
    usLinkObL0:
      at:
        offset: 0x00C0
      class: IntField
      name: usLinkObL0
      sizeBits: 20
      lsBit: 0
      mode: RO
      description: Count of outbound L0 triggers
    #########################################################
    usLinkObL1A:
      at:
        offset: 0x00C4
      class: IntField
      name: usLinkObL1A
      sizeBits: 20
      lsBit: 0
      mode: RO
      description: Count of outbound L1A triggers
    #########################################################
    usLinkObL1R:
      at:
        offset: 0x00C8
      class: IntField
      name: usLinkObL1R
      sizeBits: 20
      lsBit: 0
      mode: RO
      description: Count of outbound L1R triggers
    #########################################################
